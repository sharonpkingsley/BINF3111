<!doctype html>

<html>

<head>
    {% if title %}
    <title>{{ title }} - DrugSim</title>
    {% else %}
    <title>DrugSim</title>
    {% endif %}

    <script src="{{url_for('script')}}"></script>
</head>

<style>
    #cy {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 10%;
        left: 0%;
    }
    #table {
        position: absolute;
        left:10%;
        top:100%;
    }
</style>

<body>
    <div>DrugSim: <a href="/">Home</a></div>
    <hr>
    {% with messages = get_flashed_messages() %}
    {% if messages %}
    <ul>
        {% for message in messages %}
        <li>{{ message }} </li>
        {% endfor %}
    </ul>
    {% endif %}
    {% endwith %}
    <h1>Result</h1>   
    <div id="cy"></div>
    <script>
        window.alert('1')

        var tab = document.getElementById('cy')
        var cy = cytoscape({
            container: document.getElementById('cy'),
            
            style: [
                
                {
                    selector: 'edge',
                    style: {
                        'width': 0.5,
                        'line-color': '#ad1a66'
                    }
                }

            ],

        elements: [
            ]
        });
        
        var nodes = '{{ nodes|tojson }}'
        var edges1 = '{{ edges1|tojson }}'
        var edges2 = '{{ edges2|tojson }}'
        for (var i = 0; i < nodes.length; i++) {

            cy.add([
                { group: "nodes", data: { id: nodes[i] } }
            ]);
        }


        for (var i = 0; i < edges1.length; i++) {
            if (edges1[i] != edges2[i]) {
                cy.add([
                    {
                        group: "edges",
                        data: {
                            id: edges1[i] + edges2[i],
                            source: edges1[i],
                            target: edges2[i]
                        }
                    }
                ]);
            }
        }

        
        var options = {
        };


        cy.layout(options);
        var layout = cy.layout({ name: 'concentric' });

        layout.run();
    </script>
    <div id ="table">
    <p>
        {% for table in tables %}
        <h2>{{titles[loop.index]}}</h2>
        {{ table|safe }}
        {% endfor %}
    </p>
    </div>
</body>
</html>
