<!-- extend base layout -->
{% extends "base.html" %}

{% block content %}

<style>
    #cy {
        width: 55%;
        height: 60%;
        top: 15%;
        left: 20%;
    }
    #table {
        top: 85%;
    }
</style>

<div id='result' class='container'>
         
    <h1>Result</h1>
    
    <div class="container">
            <div id="cy">
                <script src="{{url_for('script')}}"></script>
                <script>
                    //window.alert('1');
                    var tab = document.getElementById('cy');
                    var cy = cytoscape({
                        container: document.getElementById('cy'),
                        
                        style: [
                            
                            {
                                selector: 'edge',
                                style: {
                                    'width': 0.5,
                                    'line-color': 'black',
                                    'curve-style': 'bezier',
                                    'control-point-step-size': '10'
                                }
                            },
                            {
                                selector: "edge[id *= 'target']",
                                css: {
                                    'line-color': 'yellow'
                                }
                            },
                            {
                                selector: "edge[id *= 'pathway']",
                                css: {
                                    'line-color': 'blue'
                                }
                            },
                            {
                                selector: "edge[id *= 'struct']",
                                css: {
                                    'line-color': 'green'
                                }
                            }

                        ],
                        elements: [
                        ]
                    });
                    var nodes= {{ nodes|safe }};
                    //window.alert(nodes);
                    var querynode = '{{ querynode }}';
                    cy.add([
                        { group: "nodes", data: { id: querynode } }
                    ]);
                    for (var i = 0; i < nodes.length; i++) {
                        
                        cy.add([
                            { group: "nodes", data: { id: nodes[i] } },
                            {
                                group: "edges",
                                data: {
                                    id: nodes[i] + querynode,
                                    source: querynode,
                                    target: nodes[i]
                                }
                            }
                        ]);

                    }
                    var target = {{ target|safe }}
                    var struct = {{ struct|safe }}
                    var pathway = {{ pathway|safe }}
                    //window.alert(target);
                    //window.alert(struct);
                    //window.alert(pathway);
                    for (var i = 0; i < target.length; i++) {
                        cy.add([
                            {
                                group: "edges",
                                data: {
                                    id: target[i] + querynode + 'target',
                                    source: querynode,
                                    target: target[i]
                                }
                            }
                        ]);

                    }
                    for (var i = 0; i < pathway.length; i++) {
                        cy.add([
                           {
                                group: "edges",
                                data: {
                                    id: pathway[i] + querynode + 'pathway',
                                    source: querynode,
                                    target: pathway[i]
                                }
                            }
                        ]);

                    }
                    for (var i = 0; i < struct.length; i++) {
                        cy.add([
                            {
                                group: "edges",
                                data: {
                                    id: struct[i] + querynode + 'struct',
                                    source: querynode,
                                    target: struct[i]
                                }
                            }
                        ]);

                    }


                    var options = {
                    };
                    cy.layout(options);
                    var layout = cy.layout({ name: 'concentric' });
                    layout.run();
                </script>
        </div>
    </div>
    <div id="table">
        <p>
            {% for table in tables %}
            <h3>{{titles[loop.index]}}</h3>
            {{ table|safe }}
            {% endfor %}
        </p>

        <form method="Post">
            <button type="submit" name="submit" class="btn btn-default">
                <span class="glyphicon glyphicon-download"></span> Download
            </button>
        </form>
        <a href="/search" class="btn btn-default">
            <span class="glyphicon glyphicon-search"></span> Search More...
        </a>
    </div>
</div>


{% endblock %}
